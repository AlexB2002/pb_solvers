//
//  SolverUnitTest.h
//  pbsam
//
//  Created by Felberg, Lisa on 6/8/16.
//  Copyright Â© 2016 Felberg, Lisa. All rights reserved.
//

#ifndef SolverUnitTest_h
#define SolverUnitTest_h

#include "Solver.h"

/*
 Class for unit testing solver matrices
 */
class SolverUTest : public ::testing::Test
{
  protected :

  double doubleFactorial[10] = {};
  
  virtual void SetUp()   {}
  virtual void TearDown() {}
  
  vector<double> unifSphX = {0,-0.18316353,-1.13466223,-0.774928921,0.495848189,1.61237984,1.8612696,1.14746377,-0.156480449,-1.4940578,-2.37498141,-2.52333083,-1.91787625,-0.750787101,0.658708071,1.96181151,2.86388476,3.18022946,2.85943835,1.97715718,0.707641383,-0.717540469,-2.05438631,-3.08714395,-3.65928912,-3.69180533,-3.18812857,-2.22704831,-0.946216319,0.480328887,1.86701765,3.04064737,3.86059092,4.23339289,4.1207209,3.54049941,2.56180284,1.2946653,-0.123652629,-1.54421956,-2.822101,-3.8305985,-4.47281266,-4.68965428,-4.46383607,-3.81978192,-2.81975739,-1.55682794,-0.145473043,1.28918468,2.62253561,3.74106928,4.55155167,4.98812757,5.01689251,4.63770724,3.88325614,2.81556221,1.52035094,0.0997941696,-1.33574493,-2.67630499,-3.82060754,-4.68343155,-5.20158165,-5.33807398,-5.08430677,-4.46013402,-3.51191024,-2.30871056,-0.937048064,0.505500569,1.91729125,3.19973568,4.26406532,5.03728977,5.46697055,5.5245207,5.20684529,4.53625142,3.55867,2.34033992,0.963200123,-0.480687263,-1.8953051,-3.18703271,-4.2707691,-5.07543802,-5.54853062,-5.65940731,-5.40116254,-4.79094869,-3.86875327,-2.69472006,-1.34519484,0.092245509,1.52446088,2.85875137,4.00881644,4.90029385,5.47553031,5.69728378,5.55112444,5.04638203,4.21557759,3.11237213,1.80815693,0.387495894,-1.05729682,-2.43210454,-3.64710621,-4.62263705,-5.29443499,-5.61793048,-5.5712938,-5.15702896,-4.40199262,-3.35581557,-2.08780618,-0.682514561,0.765773637,2.15926969,3.40324144,4.41247033,5.11717183,5.46796997,5.43956813,5.03283532,4.27512568,3.21876275,1.93774302,0.522837764,-0.924611197,-2.29980349,-3.50202297,-4.44208418,-5.04914034,-5.27633281,-5.10482262,-4.54584131,-3.6405272,-2.45746657,-1.08802792,0.360249436,1.7717868,3.03204879,4.03689912,4.70148712,4.96791259,4.81096574,4.24134957,3.30596081,2.0850244,0.686132045,-0.764488659,-2.13287489,-3.28955168,-4.12203328,-4.54643674,-4.51701545,-4.03250428,-3.13837049,-1.92438099,-0.517314625,0.930860805,2.25850111,3.31213105,3.96482814,4.13304802,3.78968626,2.97130982,1.77790766,0.364214552,-1.07737341,-2.3411131,-3.23703691,-3.62128906,-3.42317106,-2.66395736,-1.4627984,-0.0261507747,1.38073599,2.47872499,3.03080825,2.89998095,2.09626212,0.79824792,-0.664484132,-1.87667667,-2.44851428,-2.154569,-1.06208228,0.410513807,1.57547761,1.75422007,0.73935628,-0.742758359,-1.09609283,0.385479294,0};
  vector<double> unifSphY = {0,0.785006186,0.0744670248,-1.15288574,-1.52114697,-0.763881213,0.579590343,1.75897105,2.233832,1.8383576,0.749628614,-0.647634264,-1.91988665,-2.71506072,-2.84003488,-2.2822982,-1.18620616,0.199573568,1.58603467,2.70451183,3.35378235,3.42815727,2.92550409,1.93752593,0.626810511,-0.803817139,-2.1440806,-3.20634287,-3.84936662,-3.99352466,-3.62665729,-2.801025,-1.62278504,-0.236073429,1.19590734,2.51038337,3.56291861,4.24199991,4.47910333,4.25363542,3.59271241,2.5662417,1.27816648,-0.144993831,-1.56703617,-2.85511677,-3.89176327,-4.58486683,-4.87492104,-4.73906714,-4.1918057,-3.28252018,-2.09020624,-0.715996637,0.725794045,2.11731321,3.34670855,4.31682465,4.95243015,5.20549467,5.05820699,4.52360911,3.64390144,2.48663972,1.13918456,-0.29812863,-1.7195631,-3.02173321,-4.11098341,-4.90989015,-5.36246313,-5.43772744,-5.13148925,-4.46621685,-3.4890971,-2.26844665,-0.888760165,0.555240941,1.9651412,3.24550055,4.31021902,5.08818584,5.527858,5.60048992,5.30182814,4.65218633,3.69492016,2.49342289,1.12685335,-0.315115138,-1.73817911,-3.04954182,-4.16391048,-5.00897499,-5.53002517,-5.69342038,-5.4886991,-4.92920173,-4.05117351,-2.91140855,-1.58358689,-0.15353712,1.28627624,2.64269317,3.82785194,4.76485753,5.39276508,5.67055988,5.57987617,5.12627456,4.33898663,3.26913095,1.98650119,0.575118159,-0.872181462,-2.25978215,-3.49556985,-4.49705131,-5.19691172,-5.5476386,-5.52489289,-5.12938323,-4.3870912,-3.34780036,-2.08199204,-0.676281009,0.772334094,2.1630433,3.3981923,4.39017496,5.06777246,5.3814811,5.3074251,4.84953363,4.03977099,2.93633806,1.61990432,0.188074012,-1.25157256,-2.58940134,-3.72205526,-4.56057994,-5.03771385,-5.11374195,-4.7803886,-4.06234755,-3.01620844,-1.72673206,-0.300636982,1.1417253,2.47622866,3.58561579,4.3700561,4.7566875,4.70722666,4.22282838,3.34555379,2.15606222,0.767459639,-0.684403414,-2.05351833,-3.19816936,-3.99593284,-4.35770678,-4.23918139,-3.64824723,-2.64709916,-1.34823265,0.0958725569,1.50886581,2.7111387,3.5428792,3.8868659,3.6878872,2.96559236,1.81793299,0.413194933,-1.03003749,-2.27386406,-3.09981181,-3.35005237,-2.96402796,-2.00240143,-0.650478529,0.804798067,2.02617363,2.70148778,2.63109766,1.80685177,0.455255473,-0.984682596,-1.9714139,-2.05964334,-1.14809398,0.325569054,1.41883961,1.17386983,-0.302628838,-0.707947248,0};
  vector<double> unifSphZ = {-5.7,-5.64271357,-5.58542714,-5.5281407,-5.47085427,-5.41356784,-5.35628141,-5.29899497,-5.24170854,-5.18442211,-5.12713568,-5.06984925,-5.01256281,-4.95527638,-4.89798995,-4.84070352,-4.78341709,-4.72613065,-4.66884422,-4.61155779,-4.55427136,-4.49698492,-4.43969849,-4.38241206,-4.32512563,-4.2678392,-4.21055276,-4.15326633,-4.0959799,-4.03869347,-3.98140704,-3.9241206,-3.86683417,-3.80954774,-3.75226131,-3.69497487,-3.63768844,-3.58040201,-3.52311558,-3.46582915,-3.40854271,-3.35125628,-3.29396985,-3.23668342,-3.17939698,-3.12211055,-3.06482412,-3.00753769,-2.95025126,-2.89296482,-2.83567839,-2.77839196,-2.72110553,-2.6638191,-2.60653266,-2.54924623,-2.4919598,-2.43467337,-2.37738693,-2.3201005,-2.26281407,-2.20552764,-2.14824121,-2.09095477,-2.03366834,-1.97638191,-1.91909548,-1.86180905,-1.80452261,-1.74723618,-1.68994975,-1.63266332,-1.57537688,-1.51809045,-1.46080402,-1.40351759,-1.34623116,-1.28894472,-1.23165829,-1.17437186,-1.11708543,-1.05979899,-1.00251256,-0.945226131,-0.887939698,-0.830653266,-0.773366834,-0.716080402,-0.65879397,-0.601507538,-0.544221106,-0.486934673,-0.429648241,-0.372361809,-0.315075377,-0.257788945,-0.200502513,-0.14321608,-0.0859296482,-0.0286432161,0.0286432161,0.0859296482,0.14321608,0.200502513,0.257788945,0.315075377,0.372361809,0.429648241,0.486934673,0.544221106,0.601507538,0.65879397,0.716080402,0.773366834,0.830653266,0.887939698,0.945226131,1.00251256,1.05979899,1.11708543,1.17437186,1.23165829,1.28894472,1.34623116,1.40351759,1.46080402,1.51809045,1.57537688,1.63266332,1.68994975,1.74723618,1.80452261,1.86180905,1.91909548,1.97638191,2.03366834,2.09095477,2.14824121,2.20552764,2.26281407,2.3201005,2.37738693,2.43467337,2.4919598,2.54924623,2.60653266,2.6638191,2.72110553,2.77839196,2.83567839,2.89296482,2.95025126,3.00753769,3.06482412,3.12211055,3.17939698,3.23668342,3.29396985,3.35125628,3.40854271,3.46582915,3.52311558,3.58040201,3.63768844,3.69497487,3.75226131,3.80954774,3.86683417,3.9241206,3.98140704,4.03869347,4.0959799,4.15326633,4.21055276,4.2678392,4.32512563,4.38241206,4.43969849,4.49698492,4.55427136,4.61155779,4.66884422,4.72613065,4.78341709,4.84070352,4.89798995,4.95527638,5.01256281,5.06984925,5.12713568,5.18442211,5.24170854,5.29899497,5.35628141,5.41356784,5.47085427,5.5281407,5.58542714,5.64271357,5.7};
  
  vector<vector<double> > itermIntRR = {{11.464057403,0.974676945,3.638549649,0.448831635,0.448831635,-0.337299594,1.930280233,-0.274204228,0.318592464,0.157528290,2.435515624,-0.584220034,0.441031066,-0.584220034,0.441031066,0.217187257,-0.209436883,0.968215392,-0.034005554,-0.034005554,0.039303796,0.037128691,-0.042326323,-0.056051520,1.200367645,-0.118797190,0.128093023,0.023335661,-0.016955001,-0.025252214,0.033688446,1.749871364,0.504788022,-0.384525716,-0.193869711,0.504788022,-0.384525716,-0.193869711,0.188606058,0.259167377,0.061877242,0.012900002,0.661797515,0.087885961,-0.088442601,0.087885961,-0.088442601,-0.072362201,0.080352177,0.107028969,0.094349088,-0.053188190,-0.114830896,0.738667492,-0.057664475,-0.057664475,0.030486209,-0.001994071,0.008164271,0.009102416,0.045188997,-0.036134936,-0.019193844,-0.073755932,0.855762629,0.429815961,-0.328023543,-0.143660119,0.100393330,0.183994505,-0.009881601,0.054928445,-0.153754605,0.005696977,0.037864411,1.224210419,-0.268334802,0.209289847,0.111829594,-0.111055225,-0.268334802,0.209289847,0.111829594,-0.111055225,-0.151834188,-0.051882466,0.005738161,0.142109890,0.092610631,0.026202291,0.074355861,0.607168191,-0.156767767,0.142073808,0.100900663,-0.156767767,0.142073808,0.100900663,-0.108653032,-0.145735087,-0.107303041,0.054419531,0.150989032,0.182097985,0.080175133,0.013531773,-0.115665197,0.487021560,0.080658927,-0.036454866,0.080658927,-0.036454866,0.013904171,-0.025098862,-0.030554311,-0.087269195,0.066503022,0.048087119,0.143165563,0.078789014,-0.062310007,-0.056189345,-0.157001826,0.549119183,-0.010012622,-0.010012622,0.011986163,0.011674960,-0.013376698,-0.017694827,-0.018175862,0.010985705,0.019638519,0.030453132,0.014660125,-0.003534141,-0.016581984,-0.034591896,-0.028288791,0.692259901},{3.747864920,-1.531635200,1.051014425,0.809145249,0.809145249,-0.088222039,0.529000213,-0.297410822,-0.820009175,-0.252927225,0.512813622,-0.152805055,0.175105025,-0.152805055,0.175105025,-0.214520952,0.025047127,0.312555767,-0.274917549,-0.274917549,-0.012858331,0.199078827,0.073962783,-0.127478944,0.431272608,-0.345591825,-0.296111605,0.082916302,-0.517668681,-0.232537735,0.107294557,0.634823991,-0.185953371,-0.006498175,-0.004944255,-0.185953371,-0.006498175,-0.004944255,0.032060097,-0.108975268,0.011887261,0.065295134,0.067245687,-0.028752103,-0.094654236,-0.028752103,-0.094654236,-0.164574609,0.132449913,0.169242125,-0.128933344,-0.011799886,-0.036522422,0.288436388,-0.045742021,-0.045742021,-0.135915694,-0.031378659,0.080475568,-0.051469970,0.142716559,0.120018977,-0.009065997,-0.121103626,0.203600733,-0.295137192,-0.190535145,-0.045252098,0.074676850,0.096118876,-0.064706958,-0.969832727,-0.004525545,-0.106382073,-0.076397045,0.549937699,0.099848283,-0.201278741,0.042948436,0.047818615,0.099848283,-0.201278741,0.042948436,0.047818615,-0.162601023,0.063576736,0.189981232,0.051076202,-0.093170985,0.102794027,-0.113134721,0.128782032,-0.013811756,0.167363294,0.068944315,-0.013811756,0.167363294,0.068944315,-0.138557480,-0.074663527,-0.017726428,-0.077392786,0.026344095,-0.183221420,0.022190352,0.152242462,0.023710267,0.156183637,-0.359599126,0.101604889,-0.359599126,0.101604889,-0.078621678,0.046684569,-0.042327757,-0.143291743,-0.024250758,0.095451334,0.149671498,-0.217857360,0.036627669,-0.048299054,-0.042959937,0.375952135,0.115588739,0.115588739,-0.037581654,-0.034186754,-0.075466966,-0.139411611,-0.128317596,0.063399930,0.058166671,-0.193332491,0.088472539,0.052636603,0.117794262,0.160823282,-0.056144124,0.309687240},{4.188790205,-2.332262690,1.374685341,-0.779224566,-0.779224566,0.218904636,0.784394909,-0.032367092,-1.096463350,0.118885102,1.180777145,0.379153951,-0.312608822,0.379153951,-0.312608822,-0.355872800,0.226124646,0.323753577,0.162185361,0.162185361,0.001232827,-0.323656829,-0.051102387,0.093122329,0.508368165,-0.272597123,0.377535995,0.071652118,-1.153069055,-0.120925337,-0.050121734,0.662036711,-0.075443899,0.355857894,-0.149912209,-0.075443899,0.355857894,-0.149912209,-0.422110466,-0.167966246,0.092900880,0.088227913,0.393479514,0.002756685,0.044706890,0.002756685,0.044706890,0.120220409,-0.066142689,-0.133192150,-0.236803807,0.000818317,0.114684163,0.221901911,-0.362332983,-0.362332983,0.092253237,0.092849465,0.100469025,0.011321982,-0.241639120,-0.053229735,-0.029193695,0.065664379,0.351127758,0.684963309,-0.681914707,-0.211342309,0.073830884,-0.038815518,0.038967225,-0.627868630,0.237088592,0.111995105,-0.032032572,0.419037554,0.366279896,-0.325767818,0.084620240,0.187809291,0.366279896,-0.325767818,0.084620240,0.187809291,0.072003458,0.024691172,0.006210064,-0.223555814,-0.087661907,-0.086459293,-0.111676800,0.186324387,-0.014349828,-0.088043116,0.053528743,-0.014349828,-0.088043116,0.053528743,0.070114755,0.155138999,-0.127618345,0.104392999,-0.266727187,-0.121075500,0.087340185,-0.200313732,0.116371793,0.357472365,0.244079122,-0.142336951,0.244079122,-0.142336951,0.017294614,0.013132064,0.041404818,0.077695140,0.065492470,-0.114459737,-0.089867185,-0.129174901,-0.071838484,0.117523438,0.089195930,0.106599486,0.124237201,0.124237201,-0.000246308,-0.218068059,-0.036317111,0.082767383,0.031491144,-0.054336822,0.052525110,0.073639400,-0.283360050,0.073832803,-0.023451787,-0.055086981,0.048395201,0.568424308},{4.188790205,0.522148363,0.827498284,-1.638540050,-1.638540050,-0.103167705,0.863417124,-0.853147677,0.227083914,0.398967928,0.736769603,-0.178691707,-0.485323059,-0.178691707,-0.485323059,0.108044442,-0.128411926,0.327033969,-0.066095178,-0.066095178,0.032338359,-0.356129325,-0.044490771,-0.126444575,0.599626164,0.030374282,-0.207003562,-0.054785964,0.013209868,0.154589297,0.040659347,0.133334710,0.145458697,-0.193452946,-0.194955200,0.145458697,-0.193452946,-0.194955200,-0.423525477,0.173607440,0.121352645,0.080024324,0.375352623,0.072310768,-0.115587362,0.072310768,-0.115587362,-0.163239245,0.083474545,-0.122356286,0.179104057,-0.016150674,-0.164466166,0.336875242,0.154339031,0.154339031,-0.173192794,0.026354265,-0.024278586,0.119008534,-0.278510039,0.088744133,0.021148218,-0.008665707,0.499889444,0.277604524,-0.137183093,-0.143034645,-0.557478250,0.142316759,0.020728176,-0.007980180,0.411015710,-0.206665217,0.009792568,0.509226292,-0.219147379,-0.068254282,0.102254580,0.040701877,-0.219147379,-0.068254282,0.102254580,0.040701877,0.022873212,-0.040594358,-0.016462284,-0.021070558,0.005566059,0.018831704,-0.018374276,0.035839158,-0.190906127,0.140285213,0.087131490,-0.190906127,0.140285213,0.087131490,-0.084291136,-0.220648336,-0.082624177,-0.192590857,-0.172013241,0.197069572,0.001852724,-0.005560122,0.011463895,0.500965730,-0.458225061,0.093290831,-0.458225061,0.093290831,0.181788539,-0.042413081,0.055805837,-0.010253403,-0.012724358,0.154792266,-0.232958159,-0.043120135,0.184918054,0.019702259,-0.128168988,0.240063881,0.082025680,0.082025680,0.184630697,0.055064021,0.030100240,-0.076435493,0.069222561,-0.121557028,-0.083110862,-0.066234150,-0.525566328,-0.034910262,-0.009815005,-0.003576962,0.028527549,0.686492774}};
  vector<vector<double> > itermIntRI = {{-0.0,-0.0,-0.0,-0.0,-0.0,-0.0,-0.070045468,-0.0,-0.0,0.057261158,-0.0,-0.0,-0.0,-0.0,-0.0,0.082383768,-0.0,-0.096775649,-0.0,-0.0,-0.0,-0.055538655,-0.0,0.066150656,0.034144101,-0.0,-0.0,0.068070558,-0.0,-0.080735850,-0.040981688,-0.0,-0.0,-0.0,-0.055877319,-0.0,-0.0,-0.055877319,-0.0,0.065407915,0.031440970,-0.0,-0.043762100,-0.0,-0.0,-0.0,-0.0,0.085400129,-0.0,-0.101793577,-0.052694634,-0.0,0.071644333,0.081424970,-0.0,-0.0,-0.0,0.065864225,-0.0,-0.078240808,-0.039962773,-0.0,0.054560264,0.061395801,-0.001782985,-0.0,-0.0,-0.124518383,-0.0,0.147185932,0.073694595,-0.0,-0.101244142,-0.112228114,0.007114893,-0.0,-0.0,-0.0,0.008088456,-0.0,-0.0,-0.0,0.008088456,-0.0,-0.009052841,-0.003496506,-0.0,0.005253068,0.004618634,-0.003065182,-0.0,0.000835509,-0.0,-0.0,-0.082909126,-0.0,-0.0,-0.082909126,-0.0,0.098976319,0.051543506,-0.0,-0.069950336,-0.079848748,-0.000254308,-0.0,0.015197156,0.078707539,-0.0,-0.0,-0.0,-0.0,-0.119514808,-0.0,0.142023885,0.072644491,-0.0,-0.099135873,-0.111674655,0.002974123,-0.0,0.019400736,0.108359843,-0.004854352,-0.0,-0.0,-0.0,-0.018182948,-0.0,0.021654856,0.011172476,-0.0,-0.015205944,-0.017239307,0.000209709,-0.0,0.003133751,0.016856335,-0.000234453,-0.004866922},{0.0,0.0,0.0,0.0,0.0,0.0,-0.230649322,0.0,0.0,0.273501154,0.0,0.0,0.0,0.0,0.0,-0.035421957,0.0,-0.049475383,0.0,0.0,0.0,0.335212817,0.0,-0.056700233,-0.044136961,0.0,0.0,-0.023981095,0.0,0.307117385,0.049553572,0.0000,0.0,0.0,0.090747686,0.0,0.0,0.090747686,0.0,-0.000468208,0.013710333,0.0,0.003456526,0.0,0.0,0.0,0.0,-0.073199686,0.0,0.185746226,0.014903363,0.0,-0.148580656,-0.054561049,0.0,0.0,0.0,0.122781949,0.0,0.034450467,0.156403330,0.0,-0.063230125,-0.063009590,-0.016141831,0.0,0.0,0.105174169,0.0,-0.348368191,-0.028250529,0.0,0.244956300,-0.058374768,0.075099412,0.0,0.0,0.0,0.025379965,0.0,0.0,0.0,0.025379965,0.0,0.096482755,0.058530996,0.0,-0.057460306,0.109596974,0.041100194,0.0,-0.062075011,0.0,0.0,0.000324988,0.0,0.0,0.000324988,0.0,-0.184481774,-0.020816322,0.0,0.164200649,0.036928394,0.096402795,0.0,0.046749921,-0.034127864,0.0,0.0,0.0,0.0,0.052623957,0.0,0.017897330,-0.074553952,0.0,0.006563149,0.229629555,0.083147209,0.0,-0.077878818,-0.197226130,-0.042804112,0.0,0.0,0.0,-0.076354338,0.0,-0.046081062,0.108131494,0.0,0.098712988,0.095434024,0.257108930,0.0,0.015940161,-0.043372307,0.195938683,0.056522482},{0.0,0.0,0.0,0.0,0.0,0.0,-0.022591944,0.0,0.0,-0.264000338,0.0,0.0,0.0,0.0,0.0,-0.023614898,0.0,0.005750095,0.0,0.0,0.0,-0.258471282,0.0,0.133941146,0.027691635,0.0,0.0,0.259817096,0.0,-0.026854302,0.084646074,0.0,0.0,0.0,0.019703350,0.0,0.0,0.019703350,0.0,0.044383425,-0.123323690,0.0,-0.092858814,0.0,0.0,0.0,0.0,0.172917276,0.0,-0.120460490,-0.022512505,0.0,0.020464038,0.025638754,0.0,0.0,0.0,0.048565329,0.0,0.008013741,-0.240005924,0.0,-0.037762665,0.120925814,0.062496041,0.0,0.0,0.170867661,0.0,-0.096555537,-0.126604079,0.0,-0.006611604,0.061041077,-0.000880004,0.0,0.0,0.0,0.063559916,0.0,0.0,0.0,0.063559916,0.0,-0.086803313,0.163158508,0.0,0.065014727,-0.094316260,0.030311500,0.0,-0.019324008,0.0,0.0,0.026305257,0.0,0.0,0.026305257,0.0,0.057975799,0.005294768,0.0,-0.152482634,-0.017113389,-0.043874308,0.0,0.163050202,0.027886235,0.0,0.0,0.0,0.0,0.012241191,0.0,-0.012007122,0.143081353,0.0,-0.015605038,-0.088046639,0.007513658,0.0,0.053648527,-0.034167311,-0.038850740,0.0,0.0,0.0,-0.065083193,0.0,0.014095310,0.086236793,0.0,0.034566283,0.029944528,-0.374708415,0.0,-0.019140814,-0.111298111,0.247528678,-0.041825669},{0.0,0.0,0.0,0.0,0.0,0.0,0.095269468,0.0,0.0,0.047547383,0.0,0.0,0.0,0.0,0.0,0.011185525,0.0,0.150924501,0.0,0.0,0.0,0.388545949,0.0,0.087234299,-0.013493961,0.0,0.0,0.129320282,0.0,0.078728769,-0.070847852,0.0,0.0,0.0,0.095696277,0.0,0.0,0.095696277,0.0,-0.047656625,-0.033898378,0.0,0.106698539,0.0,0.0,0.0,0.0,0.112618996,0.0,0.256102079,0.046737600,0.0,0.007708222,-0.091364534,0.0,0.0,0.0,-0.049768914,0.0,0.018781856,0.058745188,0.0,-0.083239434,0.017045235,-0.018394829,0.0,0.0,0.043884096,0.0,-0.111276658,-0.077819772,0.0,0.303938213,0.123218937,0.066254761,0.0,0.0,0.0,-0.057898364,0.0,0.0,0.0,-0.057898364,0.0,0.058785909,0.092459051,0.0,0.057327787,-0.041698175,-0.063638294,0.0,-0.000679853,0.0,0.0,0.047980427,0.0,0.0,0.047980427,0.0,0.031335031,-0.073855460,0.0,0.306583424,0.039175469,0.063142941,0.0,0.150285768,-0.105816156,0.0,0.0,0.0,0.0,0.028689759,0.0,-0.170195341,0.020168194,0.0,0.077464396,0.089635450,-0.055127633,0.0,-0.076274416,-0.149546781,0.057548423,0.0,0.0,0.0,-0.211867012,0.0,-0.043666138,-0.033160751,0.0,0.095150452,-0.076154421,0.152639426,0.0,-0.017322115,0.032280433,0.141537841,0.082274501}};
  vector<vector<double> > itermIntIR = {{-0.0,-0.0,-0.0,0.292278223,0.292278223,-0.199146464,-0.070045468,-0.0,-0.0,-0.0,-0.0,-0.344931793,0.234866401,-0.344931793,0.234866401,0.082383768,-0.067231718,-0.096775649,-0.171575656,-0.171575656,0.116508243,0.040406660,-0.032737652,-0.047219925,0.034144101,-0.0,-0.0,-0.0,-0.0,-0.0,-0.0,-0.0,0.236205935,-0.160534543,-0.055877319,0.236205935,-0.160534543,-0.055877319,0.045377169,0.065407915,-0.046464548,0.056059992,-0.043762100,0.260520350,-0.176687353,0.260520350,-0.176687353,-0.060960661,0.049225436,0.071068895,-0.052694634,0.062790522,-0.046989380,0.081424970,-0.019535321,-0.019535321,0.014110133,0.006117861,-0.005594681,-0.007809169,0.000603254,-0.002487677,0.006479075,-0.000539798,-0.001782985,-0.0,-0.0,-0.0,-0.0,-0.0,-0.0,-0.0,-0.0,-0.0,-0.0,-0.0,-0.038246321,0.025459651,0.008088456,-0.006167013,-0.038246321,0.025459651,0.008088456,-0.006167013,-0.009052841,0.009599816,-0.010454368,0.005253068,-0.015052284,-0.010583687,0.017199962,0.000835509,-0.246285109,0.166588406,0.056831324,-0.246285109,0.166588406,0.056831324,-0.045553162,-0.065905468,0.051543506,-0.060505820,0.042896241,-0.079848748,-0.059497067,0.106767136,-0.002962872,0.078707539,0.037331904,-0.027096623,0.037331904,-0.027096623,-0.011928703,0.010983696,0.015304104,-0.000638698,0.004412936,-0.012835321,0.000176876,0.002974123,-0.013396810,0.006275043,0.001444447,-0.004854352,0.095223349,0.095223349,-0.065721756,-0.024330192,0.020513343,0.029260929,-0.014826507,0.020009707,-0.021089334,0.022390639,0.018705171,-0.039298274,0.005288854,-0.020919372,-0.033667144,-0.004866922},{0.0,0.0,0.0,-1.444392243,-1.444392243,0.285289890,-0.230649322,0.0,0.0,0.0,0.0,0.494136584,-0.518108320,0.494136584,-0.518108320,-0.035421957,0.172732749,-0.049475383,-0.564973149,-0.564973149,-0.050094212,-0.366114225,0.221891853,0.074512333,-0.044136961,0.0,0.0,0.0,0.0,0.0,0.0,0.000000000,-0.031388771,0.320036606,0.090747686,-0.031388771,0.320036606,0.090747686,-0.208095296,-0.000468208,-0.058429803,-0.206354834,0.003456526,-0.112014063,-0.090329278,-0.112014063,-0.090329278,0.096195009,0.021677468,-0.266248508,0.014903363,0.176545055,0.139735809,-0.054561049,-0.039893547,-0.039893547,0.013276356,-0.215830834,-0.020304367,-0.010113377,-0.305781341,-0.017445857,0.049772685,-0.030317969,-0.016141831,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.217565337,0.108722332,0.025379965,-0.118551968,0.217565337,0.108722332,0.025379965,-0.118551968,0.096482755,-0.078688319,-0.132486971,-0.057460306,-0.022518802,-0.020675580,0.095314517,-0.062075011,0.182157884,-0.013911418,-0.074297543,0.182157884,-0.013911418,-0.074297543,-0.002193357,0.178970337,-0.020816322,-0.080618831,-0.103707836,0.036928394,0.074424554,-0.001686122,-0.053081246,-0.034127864,0.035125936,-0.070996339,0.035125936,-0.070996339,-0.015448438,-0.013644065,-0.123319293,-0.035872705,0.090516650,0.049352869,-0.132211514,0.083147209,-0.003285950,0.102204332,0.091312289,-0.042804112,-0.123092104,-0.123092104,0.018587760,-0.084992355,0.015897003,-0.032002376,-0.141212403,0.004239859,0.054549620,0.048581166,-0.085329108,0.020517276,0.002383019,0.008101424,0.169721822,0.056522482},{.000000000,0.0,0.0,1.263466835,1.263466835,-0.461620516,-0.022591944,0.0,0.0,0.0,0.0,-0.799550188,0.424621585,-0.799550188,0.424621585,-0.023614898,-0.049810229,0.005750095,-0.055338734,-0.055338734,-0.033396508,0.365114580,0.034711767,-0.172138910,0.027691635,0.0,0.0,0.0,0.0,0.0,0.0,0.000000000,-0.023080258,-0.247157704,0.019703350,-0.023080258,-0.247157704,0.019703350,0.433436043,0.044383425,0.063048310,-0.294377596,-0.092858814,-0.074676863,0.010498189,-0.074676863,0.010498189,-0.222230378,0.083693880,0.126823038,-0.022512505,-0.128503957,0.046327438,0.025638754,0.137675905,0.137675905,-0.028470932,0.009813764,-0.065656678,-0.044776507,0.202505448,0.059956736,0.035112406,-0.135665407,0.062496041,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.137197985,0.198254504,0.063559916,-0.461541585,0.137197985,0.198254504,0.063559916,-0.461541585,-0.086803313,-0.081275898,0.348521289,0.065014727,-0.012011752,-0.016512679,-0.008663781,-0.019324008,0.056934963,0.084005124,-0.087720237,0.056934963,0.084005124,-0.087720237,-0.169723531,0.008510597,0.005294768,0.088326385,0.077706891,-0.017113389,0.087676427,0.042076944,-0.060262178,0.027886235,-0.075327006,0.005611240,-0.075327006,0.005611240,-0.068397244,0.065047566,0.061545900,-0.160521474,-0.075778116,-0.003496606,0.113703387,0.007513658,0.030536791,-0.051543849,0.016102602,-0.038850740,0.077228281,0.077228281,-0.028078026,0.024578049,-0.017163220,-0.026427338,0.041841977,0.020279813,0.004580509,-0.016930490,-0.025962503,0.002978902,0.021366009,-0.022771078,0.015814041,-0.041825669},{0.0,0.0,0.0,-1.084032411,-1.084032411,-0.172751392,0.095269468,0.0,0.0,0.0,0.0,-0.299214188,-0.570963416,-0.299214188,-0.570963416,0.011185525,0.014707904,0.150924501,0.233361585,0.233361585,0.015818722,-0.073419567,0.068163216,-0.040923858,-0.013493961,0.0,0.0,0.0,0.0,0.0,0.0,0.000000000,-0.345498689,-0.053192029,0.095696277,-0.345498689,-0.053192029,0.095696277,-0.349344340,-0.047656625,-0.035468359,-0.180455655,0.106698539,0.035371737,0.275549179,0.035371737,0.275549179,-0.052832474,-0.080903673,-0.099748986,0.046737600,-0.034112635,0.077413381,-0.091364534,0.406826410,0.406826410,0.034517765,0.021321146,-0.125236659,0.057540326,-0.233832826,0.005608944,-0.017291043,-0.105593257,-0.018394829,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.122376286,-0.212112656,-0.057898364,-0.244889167,0.122376286,-0.212112656,-0.057898364,-0.244889167,0.058785909,-0.057476443,-0.014190289,0.057327787,0.066708370,0.039201929,0.139402830,-0.000679853,0.406175118,-0.095374846,-0.068981690,0.406175118,-0.095374846,-0.068981690,0.137365211,0.077924370,-0.073855460,0.117948428,-0.106183373,0.039175469,0.030540350,-0.189475084,-0.054048654,-0.105816156,0.091325421,0.137890467,0.091325421,0.137890467,0.087894299,0.045434091,-0.006337711,-0.124939627,-0.041837239,-0.031643728,-0.114951292,-0.055127633,-0.008616459,0.005371767,-0.040165931,0.057548423,-0.037632860,-0.037632860,0.058292029,0.022750748,-0.057624624,-0.030418452,-0.004537431,-0.039585820,0.006507149,-0.019329441,-0.067667063,0.053412262,-0.009904572,0.068183047,0.014658754,0.082274501}};
  vector<vector<double> > itermIntII = {{0.0,-0.0,0.0,-0.0,-0.0,-0.0,1.958045651,-0.0,-0.0,-0.0,0.0,-0.0,-0.0,-0.0,-0.0,0.161603295,-0.0,1.065099407,-0.0,-0.0,-0.0,0.081795401,-0.0,-0.096953061,1.207548068,-0.0,-0.0,-0.0,-0.0,-0.0,-0.000000000,0.0,-0.0,-0.0,-0.111990654,-0.0,-0.0,-0.111990654,-0.0,0.132741106,0.067203504,-0.0,0.805592986,-0.0,-0.0,-0.0,-0.0,-0.125165864,-0.0,0.148364902,0.075128467,-0.0,-0.102848135,0.782611289,-0.0,-0.0,-0.0,0.005574760,-0.0,-0.006591155,-0.003303302,-0.0,0.004536812,0.005032699,0.897287335,-0.0,-0.0,-0.0,-0.0,-0.0,-0.0,-0.0,-0.0,-0.0,-0.0,0.0,-0.0,-0.0,0.020496770,-0.0,-0.0,-0.0,0.020496770,-0.0,-0.024305161,-0.012326653,-0.0,0.016866549,0.018879219,-0.000776032,-0.0,0.695004009,-0.0,-0.0,0.120293681,-0.0,-0.0,0.120293681,-0.0,-0.142598384,-0.072226145,-0.0,0.098867368,0.110556443,-0.004792192,-0.0,-0.018177793,0.591810684,-0.0,-0.0,-0.0,-0.0,-0.010068156,-0.0,0.011899430,0.005954769,-0.0,-0.008182236,-0.009066251,0.000583231,-0.0,0.001384774,0.008620724,0.697031983,-0.0,-0.0,-0.0,-0.040702708,-0.0,0.048224471,0.024374299,-0.0,-0.033387012,-0.037275063,0.001751027,-0.0,0.006053481,0.035777215,-0.003185882,0.685889921},{0.0,0.0,0.0,0.0,0.0,0.0,0.753469452,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.196336525,0.0,0.416244288,0.0,0.0,0.0,0.234510445,0.0,0.054871095,0.348379627,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.000000000,0.0,-0.036576377,0.0,0.0,-0.036576377,0.0,-0.272543608,-0.100890887,0.0,0.232384636,0.0,0.0,0.0,0.0,0.070838279,0.0,0.054033010,-0.068668627,0.0,-0.002800393,0.330681973,0.0,0.0,0.0,-0.118755532,0.0,-0.002264035,0.154490012,0.0,0.071710600,0.071972673,0.342923069,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.141014892,0.0,0.0,0.0,-0.141014892,0.0,-0.089288641,-0.042335712,0.0,0.090202068,-0.121130929,0.023656853,0.0,0.092730389,0.0,0.0,-0.088337329,0.0000,0.0,-0.088337329,0.0,0.010966540,0.073957932,0.0,-0.026185940,-0.242489610,-0.034496407,0.0,0.083569970,0.189124876,0.0,0.0,0.0,0.0,-0.003458370,0.0,-0.001514644,0.085159215,0.0,0.032209732,0.085401492,0.143750976,0.0,-0.015917536,-0.041543278,0.134136000,0.0,0.0,0.0,-0.021469972,0.0,0.022127610,0.014445316,0.0,0.014451238,0.119829514,0.131386022,0.0,-0.028961868,-0.091276120,0.029565077,0.104760070},{0.0,0.0,0.0,0.0,0.0,0.0,0.651971116,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.357616281,0.0,0.274779633,0.0,0.0,0.0,-0.042994907,0.0,-0.030648376,0.419273051,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.118803351,0.0,0.0,-0.118803351,0.0,-0.083288174,0.048625153,0.0,0.312091350,0.0,0.0,0.0,0.0,-0.039566884,0.0,0.028202782,-0.236408835,0.0,0.031902815,0.160224556,0.0,0.0,0.0,-0.001065031,0.0,0.011644476,-0.026793664,0.0,-0.011495608,-0.052503205,0.358218844,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.174254930,0.0,0.0,0.0,0.174254930,0.0,0.044033680,0.048169148,0.0,-0.320880399,-0.094169868,0.004640238,0.0,0.358912894,0.0,0.0,0.060656339,0.000000000,0.0,0.060656339,0.0,0.028554578,-0.125845282,0.0,-0.113645039,0.037223423,0.083088488,0.0,0.091852296,0.085260203,0.0,0.0,0.0,0.0,0.017787231,0.0,-0.018181168,-0.062122630,0.0,0.019241081,0.086143588,-0.252464753,0.0,-0.032990134,-0.041136626,0.195777694,0.0,0.0,0.0,0.013991556,0.0,-0.016098710,0.038757345,0.0,0.008811211,-0.033132744,0.054679378,0.0,0.001633918,-0.000791453,-0.046079645,0.014456821},{0.0,0.0,0.0,0.0,0.0,0.0,0.917383610,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.062311097,0.0,0.453653580,0.0,0.0,0.0,-0.475679824,0.0,0.105917941,0.540802500,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.000000000,0.0,-0.098772190,0.0,0.0,-0.098772190,0.0,0.047171706,0.110934172,0.0,0.496842534,0.0,0.0,0.0,0.0,0.136739474,0.0,-0.228138146,-0.116963720,0.0,0.014676496,0.166882467,0.0,0.0,0.0,-0.035651321,0.0,-0.122729793,-0.307548457,0.0,-0.050611135,0.030581306,0.366508158,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.003718008,0.0,0.0,0.0,0.003718008,0.0,0.114836574,-0.065488657,0.0,0.158410017,-0.033933705,0.089829981,0.0,0.152567344,0.0,0.0,0.040888836,0.0,0.0,0.040888836,0.0,0.044124527,-0.198275476,0.0,-0.295820752,-0.062179661,0.199908657,0.0,-0.001491372,0.299579553,0.0,0.0,0.0,0.0,-0.187472856,0.0,-0.108422787,0.036184290,0.0,0.000293960,0.001815985,0.066202914,0.0,-0.039043900,0.002586728,0.086772303,0.0,0.0,0.0,0.023698944,0.0,-0.043599086,-0.067452587,0.0,0.067338983,0.028442387,0.058486114,0.0,0.025587451,-0.016746382,0.014184733,0.030750605}};
  
  vector<vector<double> > imat = {{0.912280702,0.281188281,-0.176388716,0.175480685,0.00785994116,0.0714337733,-0.21598726,0.0814048752,0.0655589198,0.00621075429,-0.0218204792,0.105061552,-0.0326250494,0.770481328,-0.00870007542,-0.0548975999,0.0728699506,-0.204257139,-0.0446043821,0.000672075855,-0.0273071137,0.0350279004,-0.103456333,-0.0100475366,-0.00138574146,0.0803395089,0.737298421,0.0614443398,0.0520499647,0.00505439238,0.0139874851,-0.127931332,-0.114374906,0.0565548299,0.00560685203,-0.00917758617,-0.0213835655,-0.0852232714,-0.00621433958,0.999654003,0.0342036674,-0.0856478187,0.0764663284,-0.120825808,-0.00341487255,-0.00608709099,0.00585236195,-0.0260377707,-0.115972298,-0.000283320359,-0.0391974925,0.0477900421,0.847706362,-0.0243143479,0.0033134241,0.00594155704,-0.0142996334,0.012348277,-0.0140810956,0.000233633207,0.0151552667,-0.0234953024,0.0512470852},{0.298245614,-0.103583894,0.130460975,0.0696720757,0.00739549181,0.128779466,-0.00550831847,-0.10642339,-0.0281878976,-0.13230371,-0.0236672012,0.0178588304,-0.00157087641,0.248723976,-0.0112671571,0.0786442799,-0.000521623278,0.0157084119,-0.10144452,-0.340666283,-0.0899182694,0.0152744709,0.105936934,-0.0925238249,-0.00971808013,-0.0295953981,0.0749173845,-0.148550532,-0.000372588055,0.0798916754,-0.00457603925,-0.0406890677,0.0528960279,-0.21187383,0.0801836465,-0.00728006876,-0.0101002873,0.106605322,-0.00804796938,0.382045311,-0.0234862715,-0.00252092008,-0.0012075962,-0.129393783,0.045789093,0.0346265988,-0.064015642,0.119705164,-0.0594153472,0.10740087,0.0289913277,-0.115539303,0.27090143,-0.0336833588,0.092633025,0.00559046633,0.0549832712,-0.059506363,-0.110940235,0.2864411,-0.0195907168,0.0607728917,-0.130743411},{0.333333333,-0.0420254432,0.0407766635,-0.124383098,-0.0158595136,-0.124017441,-0.167014884,-0.125649984,-0.0187921384,-0.00118653517,-0.00257569131,-0.235133385,-0.121555525,0.257634911,-0.0498848167,-0.127252365,0.0494468908,0.0409014207,0.0741043946,0.225608201,-0.00880743312,-0.137393024,-0.180260089,-0.0481146628,0.0333984383,-0.0120072695,0.438369468,0.111306923,0.0353192077,-0.0128070798,0.0004387401,0.12776786,-0.0245131238,0.100922567,-0.0584930123,-0.0576670852,-0.0325242462,0.12558723,-0.0356320119,0.399086098,0.0545076483,0.132068375,0.0301353913,0.0572985313,0.0337695759,0.0218357374,0.0724319065,0.131568722,0.123455693,-0.0488796908,0.00906148078,0.0865720512,0.122126245,0.0329489072,0.00837085094,-0.0119886654,-0.00389551488,-0.0589238766,0.065864191,-0.417456875,0.0122912626,0.00510307477,-0.00113367226},{0.333333333,0.0810266474,0.2909015,-0.193103909,0.019227855,-0.260781748,-0.217196587,-0.098808993,0.00890115827,-0.0397185878,-0.067891335,-0.235921606,0.0983805852,0.260245363,0.0641047909,-0.047621417,-0.0530935116,0.0632037297,-0.100621396,-0.260509551,0.0371406498,-0.0377656614,-0.284008699,0.0615091268,0.00312441901,0.0231504707,0.418174577,-0.152096479,-0.0379239368,-0.0563850863,0.0115086162,-0.183229223,0.0561147261,-0.0793777211,0.0340701626,0.0245638197,0.0235609043,0.0437458286,0.0457891363,0.408321095,0.0220910661,0.228953137,-0.135701533,0.0182019239,-0.0708984436,0.0194767909,0.0638680048,-0.00213623349,-0.175586367,0.0703465779,0.0646447778,-0.118297261,0.4291161,0.0444088743,-0.0614168476,0.0145348922,-0.0352537903,0.0037052151,-0.060825433,0.170053234,-0.00598945566,0.0072495146,-0.0239874256},{}};
  
public:
  SolverUTest( ) {  }
  
};


TEST_F(SolverUTest, UniSphGrid)
{
  int grid = 200;
  vector<Pt> grids = make_uniform_sph_grid(grid, 5.7);
  
  for (int i = 0; i < grid; i++)
  {
    EXPECT_NEAR( grids[i].x(), unifSphX[i], preclim);
    EXPECT_NEAR( grids[i].y(), unifSphY[i], preclim);
    EXPECT_NEAR( grids[i].z(), unifSphZ[i], preclim);
  }
}

TEST_F(SolverUTest, IMATTestIntermediates)
{
  int pol = 5;
  PQRFile pqr(test_dir_loc + "test_zund.pqr");
  auto mol = make_shared<Molecule>(0, 0, "stat", pqr.get_charges(),
                                   pqr.get_atom_pts(), pqr.get_radii(),
                                   pqr.get_cg_centers(), pqr.get_cg_radii());
  auto _SHConstTest = make_shared<SHCalcConstants> (2*pol);
  auto SHCalcTest = make_shared<SHCalc> (2*pol, _SHConstTest);
  auto _expcons = make_shared<ExpansionConstants> (pol);
  IEMatrix ieMatTest(10, mol, SHCalcTest, pol, _expcons, 20);
  
  ASSERT_EQ( mol->get_gdpt_expj(0).size(), 18 );
  ASSERT_EQ( mol->get_gdpt_burj(0).size(), 2  );
  ASSERT_EQ( mol->get_gdpt_expj(1).size(), 6  );
  ASSERT_EQ( mol->get_gdpt_burj(1).size(), 14 );
  ASSERT_EQ( mol->get_gdpt_expj(2).size(), 7  );
  ASSERT_EQ( mol->get_gdpt_burj(2).size(), 13 );
  ASSERT_EQ( mol->get_gdpt_expj(3).size(), 7  );
  ASSERT_EQ( mol->get_gdpt_burj(3).size(), 13 );
  
  for (int i = 0; i < mol->get_ns(); i++)
  {
    int ct = 0;
    vector<MatOfMats<cmplx>::type > Ys = ieMatTest.compute_integral(mol,
                                                                    SHCalcTest,
                                                                    i);
    for(int l=0; l<pol; l++)
      for(int s=0; s<=l; s++)
        for(int n=0; n<=l; n++)
          for(int m=0; m<=n; m++)
          {
            EXPECT_NEAR( itermIntRR[i][ct], Ys[0](l,s)(n,m).real(), preclim);
            EXPECT_NEAR( itermIntRI[i][ct], Ys[0](l,s)(n,m).imag(), preclim);
            EXPECT_NEAR( itermIntIR[i][ct], Ys[1](l,s)(n,m).real(), preclim);
            EXPECT_NEAR( itermIntII[i][ct], Ys[1](l,s)(n,m).imag(), preclim);
            ct++;
          }
  }
}

TEST_F(SolverUTest, IMATTestImatOrig)
{
  int pol = 5;
  PQRFile pqr(test_dir_loc + "test_zund.pqr");
  auto mol = make_shared<Molecule>(0, 0, "stat", pqr.get_charges(),
                                   pqr.get_atom_pts(), pqr.get_radii(),
                                   pqr.get_cg_centers(), pqr.get_cg_radii());
  auto _SHConstTest = make_shared<SHCalcConstants> (2*pol);
  auto SHCalcTest = make_shared<SHCalc> (2*pol, _SHConstTest);
  auto _expcons = make_shared<ExpansionConstants> (pol);
  IEMatrix ieMatTest(0, mol, SHCalcTest, pol, _expcons, 20);
  
  ASSERT_EQ( mol->get_gdpt_expj(0).size(), 18 );
  ASSERT_EQ( mol->get_gdpt_burj(0).size(), 2  );
  ASSERT_EQ( mol->get_gdpt_expj(1).size(), 6  );
  ASSERT_EQ( mol->get_gdpt_burj(1).size(), 14 );
  ASSERT_EQ( mol->get_gdpt_expj(2).size(), 7  );
  ASSERT_EQ( mol->get_gdpt_burj(2).size(), 13 );
  ASSERT_EQ( mol->get_gdpt_expj(3).size(), 7  );
  ASSERT_EQ( mol->get_gdpt_burj(3).size(), 13 );
  
  for (int i = 0; i < mol->get_ns(); i++)
  {
    int ct = 0;
    for(int l=0; l<pol*pol*pol*pol; l+=10)
    {
      EXPECT_NEAR(imat[i][ct], ieMatTest.get_IE_k_ind(i,l), preclim);
      ct++;
    }
  }
}


TEST_F(SolverUTest, Efix_test)
{
  int pol = 5;
  PQRFile pqr(test_dir_loc + "test_zund.pqr");
  auto mol = make_shared<Molecule>(0, 0, "stat", pqr.get_charges(),
                                   pqr.get_atom_pts(), pqr.get_radii(),
                                   pqr.get_cg_centers(), pqr.get_cg_radii());
  auto _SHConstTest = make_shared<SHCalcConstants> (2*pol);
  auto SHCalcTest = make_shared<SHCalc> (2*pol, _SHConstTest);
  auto _expcons = make_shared<ExpansionConstants> (pol);
  EMatrix emat(0, mol->get_ns(), pol);
  emat.calc_vals((*mol), SHCalcTest, 4.0);
  
  for (int n=0; n<pol; n++)
  {
    for (int m=0; m<=n; m++)
    {
      
      
    }
    cout << endl;
  }
  
  
//  for (int i = 0; i < mol->get_ns(); i++)
//  {
//    int ct = 0;
//    for(int l=0; l<pol*pol*pol*pol; l+=10)
//    {
//      EXPECT_NEAR(imat[i][ct], ieMatTest.get_IE_k_ind(i,l), preclim);
//      ct++;
//    }
//  }
}

#endif /* SolverUnitTest_h */
